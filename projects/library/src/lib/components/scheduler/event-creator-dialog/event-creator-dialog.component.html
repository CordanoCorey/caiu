<div class="form-container">
  <h1 *ngIf="data.editing != true">New Event</h1>
  <h1 *ngIf="data.editing != false && !noEvents">Edit Event</h1>
  <mat-form-field *ngIf="data.editing != false  && hideSelect === false">
    <mat-select placeholder="Event to Edit" (selectionChange)="eventSelected($event)">
      <mat-option *ngFor="let event of eventsToday" [value]="event">{{event.eventName}}</mat-option>
    </mat-select>
  </mat-form-field>
  <button mat-fab color="warn" style="float: right;" (click)="deleteEvent(eventChosen)"
    *ngIf="eventChosen.length > 0 && data.editing != false && noEvents === false">
    <i class="material-icons">
      delete
    </i>
  </button>
  <h1 *ngIf="noEvents === true">No Events To Edit</h1>
  <form [formGroup]="form" (ngSubmit)="onSubmit()" *ngIf="data.editing != true || eventChosen[0] != null">
    <table>
      <tr>
        <td>
          <mat-form-field>
            <input type="text" formControlName="eventName" matInput placeholder="Event Name" />
          </mat-form-field>
          <mat-form-field *ngIf="eventTypes">
            <mat-select placeholder="Event Type" formControlName="eventTypeId">
              <mat-option *ngFor="let lkp of eventTypes" [value]="lkp.id">
                {{ lkp.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
      </tr>
      <tr>
        <td>
            <mat-checkbox formControlName="allDay" [(ngModel)]="checked"
            *ngIf="isAllDayEnforced === false">All Day Event</mat-checkbox>
          <mat-checkbox formControlName="allDay" [disabled]="true" [(ngModel)]="checked"
            *ngIf="isAllDayEnforced === true">All Day Event</mat-checkbox>
        </td>
      </tr>
      <tr>
        <td formGroupName="startTime">
          <span class="time-text">Start Time:</span>
          <mat-form-field class="time-fields">
            <mat-select formControlName="hour" placeholder="Hour" [disabled]="disableTime.value">
              <mat-option *ngFor="let hour of hours" [value]="hour">
                {{ hour }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="time-fields">
            <mat-select formControlName="minute" placeholder="Minute" [disabled]="disableTime.value">
              <mat-option [value]="0">00</mat-option>
              <mat-option [value]="5">05</mat-option>
              <mat-option *ngFor="let minute of minutes" [value]="minute">
                {{ minute }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="time-fields">
            <mat-select formControlName="timePeriod" placeholder="AM/PM" [disabled]="disableTime.value">
              <mat-option value="AM">AM</mat-option>
              <mat-option value="PM">PM</mat-option>
            </mat-select>
          </mat-form-field>
        </td>
      </tr>
      <tr>
        <td formGroupName="endTime">
          <span class="time-text">End Time:</span>
          <mat-form-field class="time-fields">
            <mat-select formControlName="hour" placeholder="Hour" [disabled]="disableTime.value">
              <ng-container *ngFor="let hour of hours">
                <mat-option
                  *ngIf="hour >= form.get('startTime.hour').value || form.get('startTime.timePeriod').value === 'AM'"
                  [value]="hour">
                  {{ hour }}
                </mat-option>
              </ng-container>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="time-fields">
            <mat-select formControlName="minute" placeholder="Minute" [disabled]="disableTime.value">
              <mat-option [value]="0"
                *ngIf="form.get('startTime.hour').value < form.get('endTime.hour').value || form.get('startTime.timePeriod').value === 'AM'">
                00</mat-option>
              <mat-option [value]="5"
                *ngIf="form.get('startTime.minute').value < 5 || form.get('startTime.hour').value < form.get('endTime.hour').value">
                05</mat-option>
              <ng-container *ngFor="let minute of minutes">
                <mat-option *ngIf="minute >= form.get('startTime.minute').value" [value]="minute">
                  {{ minute }}
                </mat-option>
              </ng-container>

            </mat-select>
          </mat-form-field>
          <mat-form-field class="time-fields">
            <mat-select formControlName="timePeriod" placeholder="AM/PM" [disabled]="disableTime.value">
              <mat-option value="AM"
                *ngIf="form.get('startTime.hour').value < 12 && form.get('startTime.minute').value < 55 && form.get('startTime.timePeriod').value !== 'PM' && form.get('startTime.hour').value <= form.get('endTime.hour').value">
                AM</mat-option>
              <mat-option value="PM">PM</mat-option>
            </mat-select>
          </mat-form-field>
        </td>
      </tr>
      <tr>
        <td>
          <button mat-button type="submit"><span *ngIf="data.editing != true">Submit</span><span
              *ngIf="data.editing != false">Save</span></button>
        </td>
      </tr>
    </table>
  </form>
</div>