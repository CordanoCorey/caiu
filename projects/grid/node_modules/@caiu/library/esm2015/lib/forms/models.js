/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { FormArray as Ng2FormArray } from '@angular/forms';
import { buildAbstractControl, buildControlsConfig } from './utils';
import { build, getValue, toArray } from '../shared/utils';
export class FormArray extends Ng2FormArray {
    /**
     * @param {?} fb
     * @param {?} controls
     * @param {?=} validator
     * @param {?=} asyncValidator
     */
    constructor(fb, controls, validator, asyncValidator) {
        super(controls, validator, asyncValidator);
        this.fb = fb;
    }
    /**
     * @template T
     * @param {?} fb
     * @param {?} controls
     * @param {?=} validator
     * @param {?=} asyncValidator
     * @return {?}
     */
    static Build(fb, controls, validator, asyncValidator) {
        return new FormArray(fb, controls, validator, asyncValidator);
    }
    /**
     * @template T
     * @param {?} ctor
     * @param {?} fb
     * @param {?=} controls
     * @param {?=} validator
     * @param {?=} asyncValidator
     * @return {?}
     */
    static BuildWithType(ctor, fb, controls = [], validator, asyncValidator) {
        const /** @type {?} */ fa = new FormArray(fb, controls, validator, asyncValidator);
        fa.ctor = ctor;
        return fa;
    }
    /**
     * @template T
     * @param {?} ctor
     * @param {?} value
     * @param {?} fb
     * @param {?=} controls
     * @param {?=} validator
     * @param {?=} asyncValidator
     * @return {?}
     */
    static BuildWithTypeAndValue(ctor, value, fb, controls = [], validator, asyncValidator) {
        const /** @type {?} */ fa = new FormArray(fb, controls, validator, asyncValidator);
        fa.ctor = ctor;
        fa.setValue(value);
        return fa;
    }
    /**
     * @template T
     * @param {?} value
     * @param {?} fb
     * @param {?=} controls
     * @param {?=} validator
     * @param {?=} asyncValidator
     * @return {?}
     */
    static BuildWithValue(value, fb, controls = [], validator, asyncValidator) {
        const /** @type {?} */ fa = new FormArray(fb, controls, validator, asyncValidator);
        fa.setValue(value);
        return fa;
    }
    /**
     * @param {?} value
     * @param {?} ctor
     * @return {?}
     */
    static GetValue(value, ctor) {
        return toArray(value).map(x => getValue(build(ctor, x)));
    }
    /**
     * @return {?}
     */
    get maxIndex() {
        return this.length - 1;
    }
    /**
     * @return {?}
     */
    get values() {
        return [...this.value];
    }
    /**
     * @param {?} n
     * @return {?}
     */
    buildControls(n) {
        return this.buildItems(n).map(x => buildAbstractControl(this.fb, x));
    }
    /**
     * @param {?} n
     * @return {?}
     */
    buildItems(n) {
        return Array.from(Array(n).keys()).map(x => this.ctor ? getValue(new this.ctor()) : {});
    }
    /**
     * @param {?} value
     * @return {?}
     */
    getValue(value) {
        return this.ctor ? toArray(value).map(x => getValue(build(this.ctor, x))) : value;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    resetValue(value) {
        this.removeAll();
        this.addControls(value);
        this.setValue(value);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    setLength(value) {
        if (this.length < value) {
            this.add(value - this.length);
        }
        else if (this.length > value) {
            this.remove(this.length - value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    setValue(value) {
        this.setLength(value.length);
        super.setValue(this.getValue(value));
    }
    /**
     * @param {?} id
     * @return {?}
     */
    findControlById(id) {
        return this.controls.find(control => control.value && control.value['id'] && control.value['id'] === id);
    }
    /**
     * @return {?}
     */
    removeAll() {
        this.controls = [];
    }
    /**
     * @param {?} indexes
     * @return {?}
     */
    removeIndexes(indexes) {
        indexes.forEach(index => {
            this.removeAt(index);
        });
    }
    /**
     * @param {?} n
     * @return {?}
     */
    add(n) {
        this.buildControls(n).forEach(x => {
            this.push(x);
        });
    }
    /**
     * @param {?} n
     * @return {?}
     */
    remove(n) {
        const /** @type {?} */ k = Math.min(n, this.length);
        Array.from(Array(k).keys()).forEach(x => {
            this.removeAt(this.maxIndex);
        });
    }
    /**
     * @param {?} value
     * @return {?}
     */
    addControls(value) {
        const /** @type {?} */ controls = value.map(x => this.fb.group(buildControlsConfig(x, this.fb)));
        controls.forEach(control => {
            this.push(control);
        });
    }
    /**
     * Set value of each control.
     * @param {?} ctor Class constructor
     * @param {?} props Values to assign to props of each control
     * @return {?}
     */
    setAll(ctor, props) {
        this.controls.forEach(control => {
            control.setValue(build(new ctor(), control.value, props));
        });
    }
}
function FormArray_tsickle_Closure_declarations() {
    /** @type {?} */
    FormArray.prototype.ctor;
    /** @type {?} */
    FormArray.prototype.fb;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNhaXUvbGlicmFyeS8iLCJzb3VyY2VzIjpbImxpYi9mb3Jtcy9tb2RlbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBZ0MsU0FBUyxJQUFJLFlBQVksRUFBaUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4SCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFFcEUsT0FBTyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFM0QsTUFBTSxnQkFBaUIsU0FBUSxZQUFZOzs7Ozs7O0lBK0J2QyxZQUFtQixFQUFlLEVBQUUsUUFBMkIsRUFBRSxTQUF1QixFQUFFLGNBQWlDO1FBQ3ZILEtBQUssQ0FBQyxRQUFRLEVBQUUsU0FBUyxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBRDVCLE9BQUUsR0FBRixFQUFFLENBQWE7S0FFakM7Ozs7Ozs7OztJQTdCRCxNQUFNLENBQUMsS0FBSyxDQUFJLEVBQWUsRUFBRSxRQUEyQixFQUFFLFNBQXVCLEVBQUUsY0FBaUM7UUFDcEgsTUFBTSxDQUFDLElBQUksU0FBUyxDQUFDLEVBQUUsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0tBQ2pFOzs7Ozs7Ozs7O0lBRUQsTUFBTSxDQUFDLGFBQWEsQ0FBSSxJQUF3QixFQUFFLEVBQWUsRUFBRSxXQUE4QixFQUFFLEVBQUUsU0FBdUIsRUFBRSxjQUFpQztRQUMzSix1QkFBTSxFQUFFLEdBQUcsSUFBSSxTQUFTLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsY0FBYyxDQUFDLENBQUM7UUFDbEUsRUFBRSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDZixNQUFNLENBQUMsRUFBRSxDQUFDO0tBQ2I7Ozs7Ozs7Ozs7O0lBRUQsTUFBTSxDQUFDLHFCQUFxQixDQUFJLElBQXdC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QUksRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3BDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ2hDLENBQUMsQ0FBQztLQUNOOzs7OztJQUVELFdBQVcsQ0FBQyxLQUFZO1FBQ3BCLHVCQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEYsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3RCLENBQUMsQ0FBQztLQUNOOzs7Ozs7O0lBT0QsTUFBTSxDQUFDLElBQTBCLEVBQUUsS0FBVTtRQUN6QyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUM1QixPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksRUFBRSxFQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUM3RCxDQUFDLENBQUM7S0FDTjtDQUVKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sLCBGb3JtQnVpbGRlciwgRm9ybUFycmF5IGFzIE5nMkZvcm1BcnJheSwgVmFsaWRhdG9yRm4sIEFzeW5jVmFsaWRhdG9yRm4gfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcblxyXG5pbXBvcnQgeyBidWlsZEFic3RyYWN0Q29udHJvbCwgYnVpbGRDb250cm9sc0NvbmZpZyB9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQgeyBUeXBlQ29uc3RydWN0b3IgfSBmcm9tICcuLi9zaGFyZWQvbW9kZWxzJztcclxuaW1wb3J0IHsgYnVpbGQsIGdldFZhbHVlLCB0b0FycmF5IH0gZnJvbSAnLi4vc2hhcmVkL3V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBGb3JtQXJyYXkgZXh0ZW5kcyBOZzJGb3JtQXJyYXkge1xyXG5cclxuICAgIGN0b3I6IFR5cGVDb25zdHJ1Y3Rvcjxhbnk+O1xyXG5cclxuICAgIHN0YXRpYyBCdWlsZDxUPihmYjogRm9ybUJ1aWxkZXIsIGNvbnRyb2xzOiBBYnN0cmFjdENvbnRyb2xbXSwgdmFsaWRhdG9yPzogVmFsaWRhdG9yRm4sIGFzeW5jVmFsaWRhdG9yPzogQXN5bmNWYWxpZGF0b3JGbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgRm9ybUFycmF5KGZiLCBjb250cm9scywgdmFsaWRhdG9yLCBhc3luY1ZhbGlkYXRvcik7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEJ1aWxkV2l0aFR5cGU8VD4oY3RvcjogVHlwZUNvbnN0cnVjdG9yPFQ+LCBmYjogRm9ybUJ1aWxkZXIsIGNvbnRyb2xzOiBBYnN0cmFjdENvbnRyb2xbXSA9IFtdLCB2YWxpZGF0b3I/OiBWYWxpZGF0b3JGbiwgYXN5bmNWYWxpZGF0b3I/OiBBc3luY1ZhbGlkYXRvckZuKSB7XHJcbiAgICAgICAgY29uc3QgZmEgPSBuZXcgRm9ybUFycmF5KGZiLCBjb250cm9scywgdmFsaWRhdG9yLCBhc3luY1ZhbGlkYXRvcik7XHJcbiAgICAgICAgZmEuY3RvciA9IGN0b3I7XHJcbiAgICAgICAgcmV0dXJuIGZhO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBCdWlsZFdpdGhUeXBlQW5kVmFsdWU8VD4oY3RvcjogVHlwZUNvbnN0cnVjdG9yPFQ+LCB2YWx1ZTogVFtdLCBmYjogRm9ybUJ1aWxkZXIsIGNvbnRyb2xzOiBBYnN0cmFjdENvbnRyb2xbXSA9IFtdLCB2YWxpZGF0b3I/OiBWYWxpZGF0b3JGbiwgYXN5bmNWYWxpZGF0b3I/OiBBc3luY1ZhbGlkYXRvckZuKSB7XHJcbiAgICAgICAgY29uc3QgZmEgPSBuZXcgRm9ybUFycmF5KGZiLCBjb250cm9scywgdmFsaWRhdG9yLCBhc3luY1ZhbGlkYXRvcik7XHJcbiAgICAgICAgZmEuY3RvciA9IGN0b3I7XHJcbiAgICAgICAgZmEuc2V0VmFsdWUodmFsdWUpO1xyXG4gICAgICAgIHJldHVybiBmYTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgQnVpbGRXaXRoVmFsdWU8VD4odmFsdWU6IFRbXSwgZmI6IEZvcm1CdWlsZGVyLCBjb250cm9sczogQWJzdHJhY3RDb250cm9sW10gPSBbXSwgdmFsaWRhdG9yPzogVmFsaWRhdG9yRm4sIGFzeW5jVmFsaWRhdG9yPzogQXN5bmNWYWxpZGF0b3JGbikge1xyXG4gICAgICAgIGNvbnN0IGZhID0gbmV3IEZvcm1BcnJheShmYiwgY29udHJvbHMsIHZhbGlkYXRvciwgYXN5bmNWYWxpZGF0b3IpO1xyXG4gICAgICAgIGZhLnNldFZhbHVlKHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gZmE7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEdldFZhbHVlKHZhbHVlOiBhbnlbXSwgY3RvcjogVHlwZUNvbnN0cnVjdG9yPGFueT4pOiBhbnlbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRvQXJyYXkodmFsdWUpLm1hcCh4ID0+IGdldFZhbHVlKGJ1aWxkKGN0b3IsIHgpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIGZiOiBGb3JtQnVpbGRlciwgY29udHJvbHM6IEFic3RyYWN0Q29udHJvbFtdLCB2YWxpZGF0b3I/OiBWYWxpZGF0b3JGbiwgYXN5bmNWYWxpZGF0b3I/OiBBc3luY1ZhbGlkYXRvckZuKSB7XHJcbiAgICAgICAgc3VwZXIoY29udHJvbHMsIHZhbGlkYXRvciwgYXN5bmNWYWxpZGF0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBtYXhJbmRleCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHZhbHVlcygpOiBhbnlbXSB7XHJcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLnZhbHVlXTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZENvbnRyb2xzKG46IG51bWJlcik6IEFic3RyYWN0Q29udHJvbFtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5idWlsZEl0ZW1zKG4pLm1hcCh4ID0+IGJ1aWxkQWJzdHJhY3RDb250cm9sKHRoaXMuZmIsIHgpKTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZEl0ZW1zKG46IG51bWJlcik6IGFueVtdIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShBcnJheShuKS5rZXlzKCkpLm1hcCh4ID0+IHRoaXMuY3RvciA/IGdldFZhbHVlKG5ldyB0aGlzLmN0b3IoKSkgOiB7fSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VmFsdWUodmFsdWU6IGFueVtdKTogYW55W10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN0b3IgPyB0b0FycmF5KHZhbHVlKS5tYXAoeCA9PiBnZXRWYWx1ZShidWlsZCh0aGlzLmN0b3IsIHgpKSkgOiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldFZhbHVlKHZhbHVlOiBhbnlbXSkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQWxsKCk7XHJcbiAgICAgICAgdGhpcy5hZGRDb250cm9scyh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGVuZ3RoKHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5sZW5ndGggPCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZCh2YWx1ZSAtIHRoaXMubGVuZ3RoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubGVuZ3RoID4gdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUodGhpcy5sZW5ndGggLSB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFZhbHVlKHZhbHVlOiBhbnlbXSkge1xyXG4gICAgICAgIHRoaXMuc2V0TGVuZ3RoKHZhbHVlLmxlbmd0aCk7XHJcbiAgICAgICAgc3VwZXIuc2V0VmFsdWUodGhpcy5nZXRWYWx1ZSh2YWx1ZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbmRDb250cm9sQnlJZChpZDogYW55KTogQWJzdHJhY3RDb250cm9sIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb250cm9scy5maW5kKGNvbnRyb2wgPT4gY29udHJvbC52YWx1ZSAmJiBjb250cm9sLnZhbHVlWydpZCddICYmIGNvbnRyb2wudmFsdWVbJ2lkJ10gPT09IGlkKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5jb250cm9scyA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUluZGV4ZXMoaW5kZXhlczogYW55W10pIHtcclxuICAgICAgICBpbmRleGVzLmZvckVhY2goaW5kZXggPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0KGluZGV4KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGQobjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5idWlsZENvbnRyb2xzKG4pLmZvckVhY2goeCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucHVzaCh4KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmUobjogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgayA9IE1hdGgubWluKG4sIHRoaXMubGVuZ3RoKTtcclxuICAgICAgICBBcnJheS5mcm9tKEFycmF5KGspLmtleXMoKSkuZm9yRWFjaCh4ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVBdCh0aGlzLm1heEluZGV4KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRDb250cm9scyh2YWx1ZTogYW55W10pIHtcclxuICAgICAgICBjb25zdCBjb250cm9scyA9IHZhbHVlLm1hcCh4ID0+IHRoaXMuZmIuZ3JvdXAoYnVpbGRDb250cm9sc0NvbmZpZyh4LCB0aGlzLmZiKSkpO1xyXG4gICAgICAgIGNvbnRyb2xzLmZvckVhY2goY29udHJvbCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucHVzaChjb250cm9sKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB2YWx1ZSBvZiBlYWNoIGNvbnRyb2wuXHJcbiAgICAgKiBAcGFyYW0gY3RvciBDbGFzcyBjb25zdHJ1Y3RvclxyXG4gICAgICogQHBhcmFtIHByb3BzIFZhbHVlcyB0byBhc3NpZ24gdG8gcHJvcHMgb2YgZWFjaCBjb250cm9sXHJcbiAgICAgKi9cclxuICAgIHNldEFsbChjdG9yOiBUeXBlQ29uc3RydWN0b3I8YW55PiwgcHJvcHM6IGFueSkge1xyXG4gICAgICAgIHRoaXMuY29udHJvbHMuZm9yRWFjaChjb250cm9sID0+IHtcclxuICAgICAgICAgICAgY29udHJvbC5zZXRWYWx1ZShidWlsZChuZXcgY3RvcigpLCBjb250cm9sLnZhbHVlLCBwcm9wcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=