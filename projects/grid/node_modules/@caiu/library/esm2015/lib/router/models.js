/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { build, assignProps } from '../shared/utils';
export class ActivatedRoutePayload {
    constructor() {
        this.routeName = '';
    }
}
function ActivatedRoutePayload_tsickle_Closure_declarations() {
    /** @type {?} */
    ActivatedRoutePayload.prototype.routeName;
    /** @type {?} */
    ActivatedRoutePayload.prototype.parent;
}
export class Breadcrumbs {
    /**
     * @param {?} segments
     */
    constructor(segments) {
        this.segments = segments;
    }
}
function Breadcrumbs_tsickle_Closure_declarations() {
    /** @type {?} */
    Breadcrumbs.prototype.segments;
}
export class CustomRoute {
    /**
     * @param {?} props
     */
    constructor(props) {
        this.children = [];
        this.lazyChildren = [];
        this._path = '';
        assignProps(this, props);
    }
    /**
     * @return {?}
     */
    get path() {
        return this._path;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set path(value) {
        this._path = value;
    }
    /**
     * @return {?}
     */
    get route() {
        return {
            component: this.component,
            children: [
                ...this.children,
                ...this.lazyChildren
            ]
        };
    }
}
function CustomRoute_tsickle_Closure_declarations() {
    /** @type {?} */
    CustomRoute.prototype.children;
    /** @type {?} */
    CustomRoute.prototype.lazyChildren;
    /** @type {?} */
    CustomRoute.prototype.component;
    /** @type {?} */
    CustomRoute.prototype._path;
}
export class LazyRoute extends CustomRoute {
    /**
     * @param {?} props
     */
    constructor(props) {
        super(props);
        this.path = '';
    }
}
/**
 * @record
 */
export function RouterEvent() { }
function RouterEvent_tsickle_Closure_declarations() {
    /** @type {?} */
    RouterEvent.prototype.eventType;
    /** @type {?} */
    RouterEvent.prototype.event;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationCancel;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationEnd;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationError;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationStart;
    /** @type {?|undefined} */
    RouterEvent.prototype.routesRecognized;
}
/** @enum {number} */
const NavigationStatus = {
    Default: 0,
    NavigationStart: 1,
    NavigationCancel: 2,
    NavigationError: 3,
    RoutesRecognized: 4,
    NavigationEnd: 5,
};
export { NavigationStatus };
NavigationStatus[NavigationStatus.Default] = "Default";
NavigationStatus[NavigationStatus.NavigationStart] = "NavigationStart";
NavigationStatus[NavigationStatus.NavigationCancel] = "NavigationCancel";
NavigationStatus[NavigationStatus.NavigationError] = "NavigationError";
NavigationStatus[NavigationStatus.RoutesRecognized] = "RoutesRecognized";
NavigationStatus[NavigationStatus.NavigationEnd] = "NavigationEnd";
export class RouteSegment {
    constructor() {
        /**
         * The URL fragment shared by all the routes
         */
        this.fragment = '';
        /**
         * The order of the segment in the route
         */
        this.order = 0;
        /**
         * The outlet name of the route
         */
        this.outlet = '';
        /**
         * The label to pass to the anchor tag
         */
        this.routeLabel = '';
        /**
         * The unique identifier for the route segment
         */
        this.routeName = '';
    }
    /**
     * The link to pass to the anchor tag
     * @return {?}
     */
    get routerLink() {
        return this.pathFromRoot
            .map(r => r.url)
            .reduce((acc, x) => {
            const /** @type {?} */ segment = RouterState.BuildUrlSegment(x);
            return segment && segment !== '/' ? `${acc}${segment}` : acc;
        }, '');
    }
}
function RouteSegment_tsickle_Closure_declarations() {
    /**
     * The static and resolved data of this route
     * @type {?}
     */
    RouteSegment.prototype.data;
    /**
     * The URL fragment shared by all the routes
     * @type {?}
     */
    RouteSegment.prototype.fragment;
    /**
     * The order of the segment in the route
     * @type {?}
     */
    RouteSegment.prototype.order;
    /**
     * The outlet name of the route
     * @type {?}
     */
    RouteSegment.prototype.outlet;
    /**
     * The path from the root of the router state tree to this route
     * @type {?}
     */
    RouteSegment.prototype.pathFromRoot;
    /**
     * The matrix parameters scoped to this route
     * @type {?}
     */
    RouteSegment.prototype.params;
    /**
     * The label to pass to the anchor tag
     * @type {?}
     */
    RouteSegment.prototype.routeLabel;
    /**
     * The unique identifier for the route segment
     * @type {?}
     */
    RouteSegment.prototype.routeName;
    /**
     * The URL segments matched by this route
     * @type {?}
     */
    RouteSegment.prototype.url;
}
export class RouterState {
    constructor() {
        this.id = 0;
        this.error = undefined;
        this.events = [];
        this.history = [];
        this.navigationStatus = NavigationStatus.Default;
        this.reason = '';
        this.state = undefined;
        this.url = '';
        this.urlAfterRedirects = '';
    }
    /**
     * @param {?} props
     * @return {?}
     */
    static BuildRoute(props) {
        const /** @type {?} */ r = new CustomRoute(props);
        return /** @type {?} */ (r);
    }
    /**
     * @param {?} props
     * @return {?}
     */
    static BuildLazyRoute(props) {
        const /** @type {?} */ r = new LazyRoute(props);
        return /** @type {?} */ (r);
    }
    /**
     * @param {?} url
     * @return {?}
     */
    static BuildUrlSegment(url) {
        return url.reduce((acc, segment) => segment.path && segment.path !== '/' ? `${acc}/${segment.path}` : acc, '');
    }
    /**
     * @param {?} root
     * @param {?=} index
     * @return {?}
     */
    static GetActivatedOutlets(root, index = 0) {
        return root ? root.children.reduce((acc, r, currentIndex) => {
            const /** @type {?} */ i = index + currentIndex;
            const /** @type {?} */ routeName = RouterState.GetRouteName(r);
            const /** @type {?} */ existing = build(RouteSegment, acc[routeName]);
            const /** @type {?} */ outlet = RouterState.GetRouteSegment(r, existing, i);
            return routeName ? Object.assign(acc, RouterState.GetActivatedOutlets(r, i + 1), { [routeName]: outlet })
                : Object.assign(acc, RouterState.GetActivatedOutlets(r, i + 1));
        }, {}) : {};
    }
    /**
     * @param {?} root
     * @return {?}
     */
    static GetActivatedRoute(root) {
        return root.children.reduce((acc, r) => {
            return RouterState.GetActivatedRoute(r);
        }, root);
    }
    /**
     * @param {?} route
     * @return {?}
     */
    static GetAllParams(route) {
        return route ? route.children.reduce((acc, r) => {
            return Object.assign({}, acc, RouterState.GetAllParams(r));
        }, Object.assign({}, route.params, route.queryParams)) : {};
    }
    /**
     * @param {?} route
     * @return {?}
     */
    static GetRouteData(route) {
        return route.data;
    }
    /**
     * @param {?} route
     * @param {?=} existing
     * @param {?=} index
     * @return {?}
     */
    static GetRouteSegment(route, existing = new RouteSegment(), index = 0) {
        const /** @type {?} */ routeName = RouterState.GetRouteName(route);
        return build(RouteSegment, existing, {
            data: route.data,
            fragment: route.fragment,
            order: index,
            outlet: route.outlet,
            pathFromRoot: route.pathFromRoot,
            params: route.params,
            routeName,
            routeLabel: RouterState.GetRouteData(route)['routeLabel'] || existing.routeLabel
        });
    }
    /**
     * @param {?} route
     * @return {?}
     */
    static GetRouteName(route) {
        return route ? RouterState.GetRouteData(route)['routeName'] : '';
    }
    /**
     * @return {?}
     */
    get activatedOutlets() {
        return RouterState.GetActivatedOutlets(this.rootRoute);
    }
    /**
     * @return {?}
     */
    get lastEvent() {
        return this.events[-1];
    }
    /**
     * @return {?}
     */
    get params() {
        return RouterState.GetAllParams(this.rootRoute);
    }
    /**
     * @return {?}
     */
    get routeName() {
        return RouterState.GetRouteName(this.activatedRoute);
    }
    /**
     * @return {?}
     */
    get visited() {
        return this.history.map(x => x.link);
    }
    /**
     * @param {?} e
     * @param {?} eventType
     * @return {?}
     */
    addRouterEvent(e, eventType) {
        const /** @type {?} */ newEvent = /** @type {?} */ ({ eventType: eventType, event: e });
        return [
            ...this.events,
            newEvent
        ];
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    navigationCancel(payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationCancel,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationCancel),
            id: payload.id,
            url: payload.url,
            reason: payload.reason
        });
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    navigationEnd(payload) {
        const /** @type {?} */ history = [payload.toString(), ...this.history];
        return build(RouterState, this, {
            history,
            navigationStatus: NavigationStatus.NavigationEnd,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationEnd),
            id: payload.id,
            url: payload.url,
            urlAfterRedirects: payload.urlAfterRedirects
        });
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    navigationError(payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationError,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationError),
            id: payload.id,
            url: payload.url,
            error: payload.error
        });
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    navigationStart(payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationStart,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationStart),
            id: payload.id,
            url: payload.url
        });
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    routesRecognized(payload) {
        const /** @type {?} */ rootRoute = payload.state.root;
        const /** @type {?} */ activatedRoute = RouterState.GetActivatedRoute(rootRoute);
        return build(RouterState, this, {
            activatedRoute,
            rootRoute,
            navigationStatus: NavigationStatus.RoutesRecognized,
            events: this.addRouterEvent(payload, NavigationStatus.RoutesRecognized),
            id: payload.id,
            state: payload.state,
            url: payload.url,
            urlAfterRedirects: payload.urlAfterRedirects
        });
    }
}
function RouterState_tsickle_Closure_declarations() {
    /** @type {?} */
    RouterState.prototype.id;
    /** @type {?} */
    RouterState.prototype.activatedRoute;
    /** @type {?} */
    RouterState.prototype.error;
    /** @type {?} */
    RouterState.prototype.events;
    /** @type {?} */
    RouterState.prototype.history;
    /** @type {?} */
    RouterState.prototype.navigationStatus;
    /** @type {?} */
    RouterState.prototype.reason;
    /** @type {?} */
    RouterState.prototype.rootRoute;
    /** @type {?} */
    RouterState.prototype.state;
    /** @type {?} */
    RouterState.prototype.url;
    /** @type {?} */
    RouterState.prototype.urlAfterRedirects;
}
export class VisitedRoute {
    constructor() {
        this.label = '';
        this.link = '';
        this.name = '';
        this.visitTime = new Date();
    }
}
function VisitedRoute_tsickle_Closure_declarations() {
    /** @type {?} */
    VisitedRoute.prototype.label;
    /** @type {?} */
    VisitedRoute.prototype.link;
    /** @type {?} */
    VisitedRoute.prototype.name;
    /** @type {?} */
    VisitedRoute.prototype.visitTime;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNhaXUvbGlicmFyeS8iLCJzb3VyY2VzIjpbImxpYi9yb3V0ZXIvbW9kZWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFnQkEsT0FBTyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUdyRCxNQUFNOzt5QkFDVSxFQUFFOztDQUVqQjs7Ozs7OztBQUVELE1BQU07Ozs7SUFFRixZQUFtQixRQUF3QjtRQUF4QixhQUFRLEdBQVIsUUFBUSxDQUFnQjtLQUMxQztDQUVKOzs7OztBQUVELE1BQU07Ozs7SUFNRixZQUFZLEtBQXNCO3dCQUxQLEVBQUU7NEJBQ0UsRUFBRTtxQkFFakIsRUFBRTtRQUdkLFdBQVcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7S0FDNUI7Ozs7SUFFRCxJQUFJLElBQUk7UUFDSixNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztLQUNyQjs7Ozs7SUFFRCxJQUFJLElBQUksQ0FBQyxLQUFhO1FBQ2xCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0tBQ3RCOzs7O0lBRUQsSUFBSSxLQUFLO1FBQ0wsTUFBTSxDQUFDO1lBQ0gsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1lBQ3pCLFFBQVEsRUFBRTtnQkFDTixHQUFHLElBQUksQ0FBQyxRQUFRO2dCQUNoQixHQUFHLElBQUksQ0FBQyxZQUFZO2FBQ3ZCO1NBQ0osQ0FBQTtLQUNKO0NBQ0o7Ozs7Ozs7Ozs7O0FBRUQsTUFBTSxnQkFBaUIsU0FBUSxXQUFXOzs7O0lBRXRDLFlBQVksS0FBc0I7UUFDOUIsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2IsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7S0FDbEI7Q0FDSjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXFCRCxNQUFNOzs7Ozt3QkFJUyxFQUFFOzs7O3FCQUVMLENBQUM7Ozs7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Q0YsRUFBRTt5QkFDRyxJQUFJLElBQUksRUFBRTs7Q0FDekIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUeXBlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgICBSb3V0ZSxcclxuICAgIEFjdGl2YXRlZFJvdXRlU25hcHNob3QsXHJcbiAgICBFdmVudCxcclxuICAgIE5hdmlnYXRpb25DYW5jZWwsXHJcbiAgICBOYXZpZ2F0aW9uRW5kLFxyXG4gICAgTmF2aWdhdGlvbkVycm9yLFxyXG4gICAgTmF2aWdhdGlvblN0YXJ0LFxyXG4gICAgUm91dGVzUmVjb2duaXplZCxcclxuICAgIFJvdXRlclN0YXRlU25hcHNob3QsXHJcbiAgICBVcmxTZWdtZW50LFxyXG4gICAgUGFyYW1zLFxyXG4gICAgRGF0YVxyXG59IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcblxyXG5pbXBvcnQgeyBidWlsZCwgYXNzaWduUHJvcHMgfSBmcm9tICcuLi9zaGFyZWQvdXRpbHMnO1xyXG5pbXBvcnQgeyBEaWN0aW9uYXJ5IH0gZnJvbSAnLi4vc2hhcmVkL21vZGVscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aXZhdGVkUm91dGVQYXlsb2FkIHtcclxuICAgIHJvdXRlTmFtZSA9ICcnO1xyXG4gICAgcGFyZW50Pzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQnJlYWRjcnVtYnMge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzZWdtZW50czogUm91dGVTZWdtZW50W10pIHtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDdXN0b21Sb3V0ZSBpbXBsZW1lbnRzIFJvdXRlIHtcclxuICAgIHB1YmxpYyBjaGlsZHJlbjogUm91dGVbXSA9IFtdO1xyXG4gICAgcHVibGljIGxhenlDaGlsZHJlbjogUm91dGVbXSA9IFtdO1xyXG4gICAgcHVibGljIGNvbXBvbmVudDogVHlwZTxhbnk+O1xyXG4gICAgcHJpdmF0ZSBfcGF0aCA9ICcnO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBEaWN0aW9uYXJ5PGFueT4pIHtcclxuICAgICAgICBhc3NpZ25Qcm9wcyh0aGlzLCBwcm9wcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHBhdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhdGg7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHBhdGgodmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuX3BhdGggPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgcm91dGUoKTogUm91dGUge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNvbXBvbmVudDogdGhpcy5jb21wb25lbnQsXHJcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXHJcbiAgICAgICAgICAgICAgICAuLi50aGlzLmNoaWxkcmVuLFxyXG4gICAgICAgICAgICAgICAgLi4udGhpcy5sYXp5Q2hpbGRyZW5cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIExhenlSb3V0ZSBleHRlbmRzIEN1c3RvbVJvdXRlIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogRGljdGlvbmFyeTxhbnk+KSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMucGF0aCA9ICcnO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJvdXRlckV2ZW50IHtcclxuICAgIGV2ZW50VHlwZTogYW55O1xyXG4gICAgZXZlbnQ6IEV2ZW50O1xyXG4gICAgbmF2aWdhdGlvbkNhbmNlbD86IE5hdmlnYXRpb25DYW5jZWw7XHJcbiAgICBuYXZpZ2F0aW9uRW5kPzogTmF2aWdhdGlvbkVuZDtcclxuICAgIG5hdmlnYXRpb25FcnJvcj86IE5hdmlnYXRpb25FcnJvcjtcclxuICAgIG5hdmlnYXRpb25TdGFydD86IE5hdmlnYXRpb25TdGFydDtcclxuICAgIHJvdXRlc1JlY29nbml6ZWQ/OiBSb3V0ZXNSZWNvZ25pemVkO1xyXG59XHJcblxyXG5leHBvcnQgZW51bSBOYXZpZ2F0aW9uU3RhdHVzIHtcclxuICAgIERlZmF1bHQsXHJcbiAgICBOYXZpZ2F0aW9uU3RhcnQsXHJcbiAgICBOYXZpZ2F0aW9uQ2FuY2VsLFxyXG4gICAgTmF2aWdhdGlvbkVycm9yLFxyXG4gICAgUm91dGVzUmVjb2duaXplZCxcclxuICAgIE5hdmlnYXRpb25FbmRcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJvdXRlU2VnbWVudCB7XHJcbiAgICAvKiogVGhlIHN0YXRpYyBhbmQgcmVzb2x2ZWQgZGF0YSBvZiB0aGlzIHJvdXRlICovXHJcbiAgICBkYXRhOiBEYXRhO1xyXG4gICAgLyoqIFRoZSBVUkwgZnJhZ21lbnQgc2hhcmVkIGJ5IGFsbCB0aGUgcm91dGVzICovXHJcbiAgICBmcmFnbWVudCA9ICcnO1xyXG4gICAgLyoqIFRoZSBvcmRlciBvZiB0aGUgc2VnbWVudCBpbiB0aGUgcm91dGUgKi9cclxuICAgIG9yZGVyID0gMDtcclxuICAgIC8qKiBUaGUgb3V0bGV0IG5hbWUgb2YgdGhlIHJvdXRlICovXHJcbiAgICBvdXRsZXQgPSAnJztcclxuICAgIC8qKiBUaGUgcGF0aCBmcm9tIHRoZSByb290IG9mIHRoZSByb3V0ZXIgc3RhdGUgdHJlZSB0byB0aGlzIHJvdXRlICovXHJcbiAgICBwYXRoRnJvbVJvb3Q6IEFjdGl2YXRlZFJvdXRlU25hcHNob3RbXTtcclxuICAgIC8qKiBUaGUgbWF0cml4IHBhcmFtZXRlcnMgc2NvcGVkIHRvIHRoaXMgcm91dGUgKi9cclxuICAgIHBhcmFtczogUGFyYW1zO1xyXG4gICAgLyoqIFRoZSBsYWJlbCB0byBwYXNzIHRvIHRoZSBhbmNob3IgdGFnICovXHJcbiAgICByb3V0ZUxhYmVsID0gJyc7XHJcbiAgICAvKiogVGhlIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgcm91dGUgc2VnbWVudCAqL1xyXG4gICAgcm91dGVOYW1lID0gJyc7XHJcbiAgICAvKiogVGhlIFVSTCBzZWdtZW50cyBtYXRjaGVkIGJ5IHRoaXMgcm91dGUgKi9cclxuICAgIHVybDogVXJsU2VnbWVudFtdO1xyXG5cclxuICAgIC8qKiBUaGUgbGluayB0byBwYXNzIHRvIHRoZSBhbmNob3IgdGFnICovXHJcbiAgICBnZXQgcm91dGVyTGluaygpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhdGhGcm9tUm9vdFxyXG4gICAgICAgICAgICAubWFwKHIgPT4gci51cmwpXHJcbiAgICAgICAgICAgIC5yZWR1Y2UoKGFjYywgeCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VnbWVudCA9IFJvdXRlclN0YXRlLkJ1aWxkVXJsU2VnbWVudCh4KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWdtZW50ICYmIHNlZ21lbnQgIT09ICcvJyA/IGAke2FjY30ke3NlZ21lbnR9YCA6IGFjYztcclxuICAgICAgICAgICAgfSwgJycpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUm91dGVyU3RhdGUge1xyXG4gICAgaWQgPSAwO1xyXG4gICAgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3Q7XHJcbiAgICBlcnJvcjogYW55ID0gdW5kZWZpbmVkO1xyXG4gICAgZXZlbnRzOiBSb3V0ZXJFdmVudFtdID0gW107XHJcbiAgICBoaXN0b3J5OiBWaXNpdGVkUm91dGVbXSA9IFtdO1xyXG4gICAgbmF2aWdhdGlvblN0YXR1czogTmF2aWdhdGlvblN0YXR1cyA9IE5hdmlnYXRpb25TdGF0dXMuRGVmYXVsdDtcclxuICAgIHJlYXNvbiA9ICcnO1xyXG4gICAgcm9vdFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90O1xyXG4gICAgc3RhdGU6IFJvdXRlclN0YXRlU25hcHNob3QgPSB1bmRlZmluZWQ7XHJcbiAgICB1cmwgPSAnJztcclxuICAgIHVybEFmdGVyUmVkaXJlY3RzID0gJyc7XHJcblxyXG4gICAgc3RhdGljIEJ1aWxkUm91dGUocHJvcHM6IERpY3Rpb25hcnk8YW55Pik6IFJvdXRlIHtcclxuICAgICAgICBjb25zdCByID0gbmV3IEN1c3RvbVJvdXRlKHByb3BzKTtcclxuICAgICAgICByZXR1cm4gPFJvdXRlPnI7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEJ1aWxkTGF6eVJvdXRlKHByb3BzOiBEaWN0aW9uYXJ5PGFueT4pOiBSb3V0ZSB7XHJcbiAgICAgICAgY29uc3QgciA9IG5ldyBMYXp5Um91dGUocHJvcHMpO1xyXG4gICAgICAgIHJldHVybiA8Um91dGU+cjtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgQnVpbGRVcmxTZWdtZW50KHVybDogVXJsU2VnbWVudFtdKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdXJsLnJlZHVjZSgoYWNjLCBzZWdtZW50KSA9PiBzZWdtZW50LnBhdGggJiYgc2VnbWVudC5wYXRoICE9PSAnLycgPyBgJHthY2N9LyR7c2VnbWVudC5wYXRofWAgOiBhY2MsICcnKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0QWN0aXZhdGVkT3V0bGV0cyhyb290OiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LCBpbmRleCA9IDApOiBEaWN0aW9uYXJ5PFJvdXRlU2VnbWVudD4ge1xyXG4gICAgICAgIHJldHVybiByb290ID8gcm9vdC5jaGlsZHJlbi5yZWR1Y2UoKGFjYzogRGljdGlvbmFyeTxSb3V0ZVNlZ21lbnQ+LCByOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LCBjdXJyZW50SW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGluZGV4ICsgY3VycmVudEluZGV4O1xyXG4gICAgICAgICAgICBjb25zdCByb3V0ZU5hbWUgPSBSb3V0ZXJTdGF0ZS5HZXRSb3V0ZU5hbWUocik7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gYnVpbGQoUm91dGVTZWdtZW50LCBhY2Nbcm91dGVOYW1lXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG91dGxldCA9IFJvdXRlclN0YXRlLkdldFJvdXRlU2VnbWVudChyLCBleGlzdGluZywgaSk7XHJcbiAgICAgICAgICAgIHJldHVybiByb3V0ZU5hbWUgPyBPYmplY3QuYXNzaWduKGFjYywgUm91dGVyU3RhdGUuR2V0QWN0aXZhdGVkT3V0bGV0cyhyLCBpICsgMSksIHsgW3JvdXRlTmFtZV06IG91dGxldCB9KVxyXG4gICAgICAgICAgICAgICAgOiBPYmplY3QuYXNzaWduKGFjYywgUm91dGVyU3RhdGUuR2V0QWN0aXZhdGVkT3V0bGV0cyhyLCBpICsgMSkpO1xyXG4gICAgICAgIH0sIHt9KSA6IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBHZXRBY3RpdmF0ZWRSb3V0ZShyb290OiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCB7XHJcbiAgICAgICAgcmV0dXJuIHJvb3QuY2hpbGRyZW4ucmVkdWNlKChhY2M6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIHI6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIFJvdXRlclN0YXRlLkdldEFjdGl2YXRlZFJvdXRlKHIpO1xyXG4gICAgICAgIH0sIHJvb3QpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBHZXRBbGxQYXJhbXMocm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiByb3V0ZSA/IHJvdXRlLmNoaWxkcmVuLnJlZHVjZSgoYWNjOiBhbnksIHI6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGFjYywgUm91dGVyU3RhdGUuR2V0QWxsUGFyYW1zKHIpKTtcclxuICAgICAgICB9LCBPYmplY3QuYXNzaWduKHt9LCByb3V0ZS5wYXJhbXMsIHJvdXRlLnF1ZXJ5UGFyYW1zKSkgOiB7fTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0Um91dGVEYXRhKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KTogYW55IHtcclxuICAgICAgICByZXR1cm4gcm91dGUuZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0Um91dGVTZWdtZW50KHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LCBleGlzdGluZzogUm91dGVTZWdtZW50ID0gbmV3IFJvdXRlU2VnbWVudCgpLCBpbmRleCA9IDApOiBSb3V0ZVNlZ21lbnQge1xyXG4gICAgICAgIGNvbnN0IHJvdXRlTmFtZSA9IFJvdXRlclN0YXRlLkdldFJvdXRlTmFtZShyb3V0ZSk7XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFJvdXRlU2VnbWVudCwgZXhpc3RpbmcsIHtcclxuICAgICAgICAgICAgZGF0YTogcm91dGUuZGF0YSxcclxuICAgICAgICAgICAgZnJhZ21lbnQ6IHJvdXRlLmZyYWdtZW50LFxyXG4gICAgICAgICAgICBvcmRlcjogaW5kZXgsXHJcbiAgICAgICAgICAgIG91dGxldDogcm91dGUub3V0bGV0LFxyXG4gICAgICAgICAgICBwYXRoRnJvbVJvb3Q6IHJvdXRlLnBhdGhGcm9tUm9vdCxcclxuICAgICAgICAgICAgcGFyYW1zOiByb3V0ZS5wYXJhbXMsXHJcbiAgICAgICAgICAgIHJvdXRlTmFtZSxcclxuICAgICAgICAgICAgcm91dGVMYWJlbDogUm91dGVyU3RhdGUuR2V0Um91dGVEYXRhKHJvdXRlKVsncm91dGVMYWJlbCddIHx8IGV4aXN0aW5nLnJvdXRlTGFiZWxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0Um91dGVOYW1lKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gcm91dGUgPyBSb3V0ZXJTdGF0ZS5HZXRSb3V0ZURhdGEocm91dGUpWydyb3V0ZU5hbWUnXSA6ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBhY3RpdmF0ZWRPdXRsZXRzKCk6IERpY3Rpb25hcnk8Um91dGVTZWdtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIFJvdXRlclN0YXRlLkdldEFjdGl2YXRlZE91dGxldHModGhpcy5yb290Um91dGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBsYXN0RXZlbnQoKTogUm91dGVyRXZlbnQge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50c1stMV07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHBhcmFtcygpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiBSb3V0ZXJTdGF0ZS5HZXRBbGxQYXJhbXModGhpcy5yb290Um91dGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCByb3V0ZU5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gUm91dGVyU3RhdGUuR2V0Um91dGVOYW1lKHRoaXMuYWN0aXZhdGVkUm91dGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB2aXNpdGVkKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oaXN0b3J5Lm1hcCh4ID0+IHgubGluayk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUm91dGVyRXZlbnQoZTogRXZlbnQsIGV2ZW50VHlwZTogYW55KTogUm91dGVyRXZlbnRbXSB7XHJcbiAgICAgICAgY29uc3QgbmV3RXZlbnQgPSA8Um91dGVyRXZlbnQ+eyBldmVudFR5cGU6IGV2ZW50VHlwZSwgZXZlbnQ6IGUgfTtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAuLi50aGlzLmV2ZW50cyxcclxuICAgICAgICAgICAgbmV3RXZlbnRcclxuICAgICAgICBdO1xyXG4gICAgfVxyXG5cclxuICAgIG5hdmlnYXRpb25DYW5jZWwocGF5bG9hZDogTmF2aWdhdGlvbkNhbmNlbCk6IFJvdXRlclN0YXRlIHtcclxuICAgICAgICByZXR1cm4gYnVpbGQoUm91dGVyU3RhdGUsIHRoaXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvbkNhbmNlbCxcclxuICAgICAgICAgICAgICAgIGV2ZW50czogdGhpcy5hZGRSb3V0ZXJFdmVudChwYXlsb2FkLCBOYXZpZ2F0aW9uU3RhdHVzLk5hdmlnYXRpb25DYW5jZWwpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IHBheWxvYWQuaWQsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHBheWxvYWQudXJsLFxyXG4gICAgICAgICAgICAgICAgcmVhc29uOiBwYXlsb2FkLnJlYXNvblxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuYXZpZ2F0aW9uRW5kKHBheWxvYWQ6IE5hdmlnYXRpb25FbmQpOiBSb3V0ZXJTdGF0ZSB7XHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IFtwYXlsb2FkLnRvU3RyaW5nKCksIC4uLnRoaXMuaGlzdG9yeV07XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFJvdXRlclN0YXRlLCB0aGlzLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBoaXN0b3J5LFxyXG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvblN0YXR1czogTmF2aWdhdGlvblN0YXR1cy5OYXZpZ2F0aW9uRW5kLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRzOiB0aGlzLmFkZFJvdXRlckV2ZW50KHBheWxvYWQsIE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvbkVuZCksXHJcbiAgICAgICAgICAgICAgICBpZDogcGF5bG9hZC5pZCxcclxuICAgICAgICAgICAgICAgIHVybDogcGF5bG9hZC51cmwsXHJcbiAgICAgICAgICAgICAgICB1cmxBZnRlclJlZGlyZWN0czogcGF5bG9hZC51cmxBZnRlclJlZGlyZWN0c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuYXZpZ2F0aW9uRXJyb3IocGF5bG9hZDogTmF2aWdhdGlvbkVycm9yKTogUm91dGVyU3RhdGUge1xyXG4gICAgICAgIHJldHVybiBidWlsZChSb3V0ZXJTdGF0ZSwgdGhpcyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvblN0YXR1czogTmF2aWdhdGlvblN0YXR1cy5OYXZpZ2F0aW9uRXJyb3IsXHJcbiAgICAgICAgICAgICAgICBldmVudHM6IHRoaXMuYWRkUm91dGVyRXZlbnQocGF5bG9hZCwgTmF2aWdhdGlvblN0YXR1cy5OYXZpZ2F0aW9uRXJyb3IpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IHBheWxvYWQuaWQsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHBheWxvYWQudXJsLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6IHBheWxvYWQuZXJyb3JcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmF2aWdhdGlvblN0YXJ0KHBheWxvYWQ6IE5hdmlnYXRpb25TdGFydCk6IFJvdXRlclN0YXRlIHtcclxuICAgICAgICByZXR1cm4gYnVpbGQoUm91dGVyU3RhdGUsIHRoaXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvblN0YXJ0LFxyXG4gICAgICAgICAgICAgICAgZXZlbnRzOiB0aGlzLmFkZFJvdXRlckV2ZW50KHBheWxvYWQsIE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvblN0YXJ0KSxcclxuICAgICAgICAgICAgICAgIGlkOiBwYXlsb2FkLmlkLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBwYXlsb2FkLnVybFxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByb3V0ZXNSZWNvZ25pemVkKHBheWxvYWQ6IFJvdXRlc1JlY29nbml6ZWQpOiBSb3V0ZXJTdGF0ZSB7XHJcbiAgICAgICAgY29uc3Qgcm9vdFJvdXRlID0gcGF5bG9hZC5zdGF0ZS5yb290O1xyXG4gICAgICAgIGNvbnN0IGFjdGl2YXRlZFJvdXRlID0gUm91dGVyU3RhdGUuR2V0QWN0aXZhdGVkUm91dGUocm9vdFJvdXRlKTtcclxuICAgICAgICByZXR1cm4gYnVpbGQoUm91dGVyU3RhdGUsIHRoaXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2YXRlZFJvdXRlLFxyXG4gICAgICAgICAgICAgICAgcm9vdFJvdXRlLFxyXG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvblN0YXR1czogTmF2aWdhdGlvblN0YXR1cy5Sb3V0ZXNSZWNvZ25pemVkLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRzOiB0aGlzLmFkZFJvdXRlckV2ZW50KHBheWxvYWQsIE5hdmlnYXRpb25TdGF0dXMuUm91dGVzUmVjb2duaXplZCksXHJcbiAgICAgICAgICAgICAgICBpZDogcGF5bG9hZC5pZCxcclxuICAgICAgICAgICAgICAgIHN0YXRlOiBwYXlsb2FkLnN0YXRlLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBwYXlsb2FkLnVybCxcclxuICAgICAgICAgICAgICAgIHVybEFmdGVyUmVkaXJlY3RzOiBwYXlsb2FkLnVybEFmdGVyUmVkaXJlY3RzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFZpc2l0ZWRSb3V0ZSB7XHJcbiAgICBsYWJlbCA9ICcnO1xyXG4gICAgbGluayA9ICcnO1xyXG4gICAgbmFtZSA9ICcnO1xyXG4gICAgdmlzaXRUaW1lID0gbmV3IERhdGUoKTtcclxufVxyXG4iXX0=