/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
import { build, assignProps } from '../shared/utils';
var ActivatedRoutePayload = /** @class */ (function () {
    function ActivatedRoutePayload() {
        this.routeName = '';
    }
    return ActivatedRoutePayload;
}());
export { ActivatedRoutePayload };
function ActivatedRoutePayload_tsickle_Closure_declarations() {
    /** @type {?} */
    ActivatedRoutePayload.prototype.routeName;
    /** @type {?} */
    ActivatedRoutePayload.prototype.parent;
}
var Breadcrumbs = /** @class */ (function () {
    function Breadcrumbs(segments) {
        this.segments = segments;
    }
    return Breadcrumbs;
}());
export { Breadcrumbs };
function Breadcrumbs_tsickle_Closure_declarations() {
    /** @type {?} */
    Breadcrumbs.prototype.segments;
}
var CustomRoute = /** @class */ (function () {
    function CustomRoute(props) {
        this.children = [];
        this.lazyChildren = [];
        this._path = '';
        assignProps(this, props);
    }
    Object.defineProperty(CustomRoute.prototype, "path", {
        get: /**
         * @return {?}
         */
        function () {
            return this._path;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._path = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CustomRoute.prototype, "route", {
        get: /**
         * @return {?}
         */
        function () {
            return {
                component: this.component,
                children: tslib_1.__spread(this.children, this.lazyChildren)
            };
        },
        enumerable: true,
        configurable: true
    });
    return CustomRoute;
}());
export { CustomRoute };
function CustomRoute_tsickle_Closure_declarations() {
    /** @type {?} */
    CustomRoute.prototype.children;
    /** @type {?} */
    CustomRoute.prototype.lazyChildren;
    /** @type {?} */
    CustomRoute.prototype.component;
    /** @type {?} */
    CustomRoute.prototype._path;
}
var LazyRoute = /** @class */ (function (_super) {
    tslib_1.__extends(LazyRoute, _super);
    function LazyRoute(props) {
        var _this = _super.call(this, props) || this;
        _this.path = '';
        return _this;
    }
    return LazyRoute;
}(CustomRoute));
export { LazyRoute };
/**
 * @record
 */
export function RouterEvent() { }
function RouterEvent_tsickle_Closure_declarations() {
    /** @type {?} */
    RouterEvent.prototype.eventType;
    /** @type {?} */
    RouterEvent.prototype.event;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationCancel;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationEnd;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationError;
    /** @type {?|undefined} */
    RouterEvent.prototype.navigationStart;
    /** @type {?|undefined} */
    RouterEvent.prototype.routesRecognized;
}
/** @enum {number} */
var NavigationStatus = {
    Default: 0,
    NavigationStart: 1,
    NavigationCancel: 2,
    NavigationError: 3,
    RoutesRecognized: 4,
    NavigationEnd: 5,
};
export { NavigationStatus };
NavigationStatus[NavigationStatus.Default] = "Default";
NavigationStatus[NavigationStatus.NavigationStart] = "NavigationStart";
NavigationStatus[NavigationStatus.NavigationCancel] = "NavigationCancel";
NavigationStatus[NavigationStatus.NavigationError] = "NavigationError";
NavigationStatus[NavigationStatus.RoutesRecognized] = "RoutesRecognized";
NavigationStatus[NavigationStatus.NavigationEnd] = "NavigationEnd";
var RouteSegment = /** @class */ (function () {
    function RouteSegment() {
        /**
         * The URL fragment shared by all the routes
         */
        this.fragment = '';
        /**
         * The order of the segment in the route
         */
        this.order = 0;
        /**
         * The outlet name of the route
         */
        this.outlet = '';
        /**
         * The label to pass to the anchor tag
         */
        this.routeLabel = '';
        /**
         * The unique identifier for the route segment
         */
        this.routeName = '';
    }
    Object.defineProperty(RouteSegment.prototype, "routerLink", {
        /** The link to pass to the anchor tag */
        get: /**
         * The link to pass to the anchor tag
         * @return {?}
         */
        function () {
            return this.pathFromRoot
                .map(function (r) { return r.url; })
                .reduce(function (acc, x) {
                var /** @type {?} */ segment = RouterState.BuildUrlSegment(x);
                return segment && segment !== '/' ? "" + acc + segment : acc;
            }, '');
        },
        enumerable: true,
        configurable: true
    });
    return RouteSegment;
}());
export { RouteSegment };
function RouteSegment_tsickle_Closure_declarations() {
    /**
     * The static and resolved data of this route
     * @type {?}
     */
    RouteSegment.prototype.data;
    /**
     * The URL fragment shared by all the routes
     * @type {?}
     */
    RouteSegment.prototype.fragment;
    /**
     * The order of the segment in the route
     * @type {?}
     */
    RouteSegment.prototype.order;
    /**
     * The outlet name of the route
     * @type {?}
     */
    RouteSegment.prototype.outlet;
    /**
     * The path from the root of the router state tree to this route
     * @type {?}
     */
    RouteSegment.prototype.pathFromRoot;
    /**
     * The matrix parameters scoped to this route
     * @type {?}
     */
    RouteSegment.prototype.params;
    /**
     * The label to pass to the anchor tag
     * @type {?}
     */
    RouteSegment.prototype.routeLabel;
    /**
     * The unique identifier for the route segment
     * @type {?}
     */
    RouteSegment.prototype.routeName;
    /**
     * The URL segments matched by this route
     * @type {?}
     */
    RouteSegment.prototype.url;
}
var RouterState = /** @class */ (function () {
    function RouterState() {
        this.id = 0;
        this.error = undefined;
        this.events = [];
        this.history = [];
        this.navigationStatus = NavigationStatus.Default;
        this.reason = '';
        this.state = undefined;
        this.url = '';
        this.urlAfterRedirects = '';
    }
    /**
     * @param {?} props
     * @return {?}
     */
    RouterState.BuildRoute = /**
     * @param {?} props
     * @return {?}
     */
    function (props) {
        var /** @type {?} */ r = new CustomRoute(props);
        return /** @type {?} */ (r);
    };
    /**
     * @param {?} props
     * @return {?}
     */
    RouterState.BuildLazyRoute = /**
     * @param {?} props
     * @return {?}
     */
    function (props) {
        var /** @type {?} */ r = new LazyRoute(props);
        return /** @type {?} */ (r);
    };
    /**
     * @param {?} url
     * @return {?}
     */
    RouterState.BuildUrlSegment = /**
     * @param {?} url
     * @return {?}
     */
    function (url) {
        return url.reduce(function (acc, segment) { return segment.path && segment.path !== '/' ? acc + "/" + segment.path : acc; }, '');
    };
    /**
     * @param {?} root
     * @param {?=} index
     * @return {?}
     */
    RouterState.GetActivatedOutlets = /**
     * @param {?} root
     * @param {?=} index
     * @return {?}
     */
    function (root, index) {
        if (index === void 0) { index = 0; }
        return root ? root.children.reduce(function (acc, r, currentIndex) {
            var /** @type {?} */ i = index + currentIndex;
            var /** @type {?} */ routeName = RouterState.GetRouteName(r);
            var /** @type {?} */ existing = build(RouteSegment, acc[routeName]);
            var /** @type {?} */ outlet = RouterState.GetRouteSegment(r, existing, i);
            return routeName ? Object.assign(acc, RouterState.GetActivatedOutlets(r, i + 1), (_a = {}, _a[routeName] = outlet, _a))
                : Object.assign(acc, RouterState.GetActivatedOutlets(r, i + 1));
            var _a;
        }, {}) : {};
    };
    /**
     * @param {?} root
     * @return {?}
     */
    RouterState.GetActivatedRoute = /**
     * @param {?} root
     * @return {?}
     */
    function (root) {
        return root.children.reduce(function (acc, r) {
            return RouterState.GetActivatedRoute(r);
        }, root);
    };
    /**
     * @param {?} route
     * @return {?}
     */
    RouterState.GetAllParams = /**
     * @param {?} route
     * @return {?}
     */
    function (route) {
        return route ? route.children.reduce(function (acc, r) {
            return Object.assign({}, acc, RouterState.GetAllParams(r));
        }, Object.assign({}, route.params, route.queryParams)) : {};
    };
    /**
     * @param {?} route
     * @return {?}
     */
    RouterState.GetRouteData = /**
     * @param {?} route
     * @return {?}
     */
    function (route) {
        return route.data;
    };
    /**
     * @param {?} route
     * @param {?=} existing
     * @param {?=} index
     * @return {?}
     */
    RouterState.GetRouteSegment = /**
     * @param {?} route
     * @param {?=} existing
     * @param {?=} index
     * @return {?}
     */
    function (route, existing, index) {
        if (existing === void 0) { existing = new RouteSegment(); }
        if (index === void 0) { index = 0; }
        var /** @type {?} */ routeName = RouterState.GetRouteName(route);
        return build(RouteSegment, existing, {
            data: route.data,
            fragment: route.fragment,
            order: index,
            outlet: route.outlet,
            pathFromRoot: route.pathFromRoot,
            params: route.params,
            routeName: routeName,
            routeLabel: RouterState.GetRouteData(route)['routeLabel'] || existing.routeLabel
        });
    };
    /**
     * @param {?} route
     * @return {?}
     */
    RouterState.GetRouteName = /**
     * @param {?} route
     * @return {?}
     */
    function (route) {
        return route ? RouterState.GetRouteData(route)['routeName'] : '';
    };
    Object.defineProperty(RouterState.prototype, "activatedOutlets", {
        get: /**
         * @return {?}
         */
        function () {
            return RouterState.GetActivatedOutlets(this.rootRoute);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RouterState.prototype, "lastEvent", {
        get: /**
         * @return {?}
         */
        function () {
            return this.events[-1];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RouterState.prototype, "params", {
        get: /**
         * @return {?}
         */
        function () {
            return RouterState.GetAllParams(this.rootRoute);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RouterState.prototype, "routeName", {
        get: /**
         * @return {?}
         */
        function () {
            return RouterState.GetRouteName(this.activatedRoute);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RouterState.prototype, "visited", {
        get: /**
         * @return {?}
         */
        function () {
            return this.history.map(function (x) { return x.link; });
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} e
     * @param {?} eventType
     * @return {?}
     */
    RouterState.prototype.addRouterEvent = /**
     * @param {?} e
     * @param {?} eventType
     * @return {?}
     */
    function (e, eventType) {
        var /** @type {?} */ newEvent = /** @type {?} */ ({ eventType: eventType, event: e });
        return tslib_1.__spread(this.events, [
            newEvent
        ]);
    };
    /**
     * @param {?} payload
     * @return {?}
     */
    RouterState.prototype.navigationCancel = /**
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationCancel,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationCancel),
            id: payload.id,
            url: payload.url,
            reason: payload.reason
        });
    };
    /**
     * @param {?} payload
     * @return {?}
     */
    RouterState.prototype.navigationEnd = /**
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        var /** @type {?} */ history = tslib_1.__spread([payload.toString()], this.history);
        return build(RouterState, this, {
            history: history,
            navigationStatus: NavigationStatus.NavigationEnd,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationEnd),
            id: payload.id,
            url: payload.url,
            urlAfterRedirects: payload.urlAfterRedirects
        });
    };
    /**
     * @param {?} payload
     * @return {?}
     */
    RouterState.prototype.navigationError = /**
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationError,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationError),
            id: payload.id,
            url: payload.url,
            error: payload.error
        });
    };
    /**
     * @param {?} payload
     * @return {?}
     */
    RouterState.prototype.navigationStart = /**
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        return build(RouterState, this, {
            navigationStatus: NavigationStatus.NavigationStart,
            events: this.addRouterEvent(payload, NavigationStatus.NavigationStart),
            id: payload.id,
            url: payload.url
        });
    };
    /**
     * @param {?} payload
     * @return {?}
     */
    RouterState.prototype.routesRecognized = /**
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        var /** @type {?} */ rootRoute = payload.state.root;
        var /** @type {?} */ activatedRoute = RouterState.GetActivatedRoute(rootRoute);
        return build(RouterState, this, {
            activatedRoute: activatedRoute,
            rootRoute: rootRoute,
            navigationStatus: NavigationStatus.RoutesRecognized,
            events: this.addRouterEvent(payload, NavigationStatus.RoutesRecognized),
            id: payload.id,
            state: payload.state,
            url: payload.url,
            urlAfterRedirects: payload.urlAfterRedirects
        });
    };
    return RouterState;
}());
export { RouterState };
function RouterState_tsickle_Closure_declarations() {
    /** @type {?} */
    RouterState.prototype.id;
    /** @type {?} */
    RouterState.prototype.activatedRoute;
    /** @type {?} */
    RouterState.prototype.error;
    /** @type {?} */
    RouterState.prototype.events;
    /** @type {?} */
    RouterState.prototype.history;
    /** @type {?} */
    RouterState.prototype.navigationStatus;
    /** @type {?} */
    RouterState.prototype.reason;
    /** @type {?} */
    RouterState.prototype.rootRoute;
    /** @type {?} */
    RouterState.prototype.state;
    /** @type {?} */
    RouterState.prototype.url;
    /** @type {?} */
    RouterState.prototype.urlAfterRedirects;
}
var VisitedRoute = /** @class */ (function () {
    function VisitedRoute() {
        this.label = '';
        this.link = '';
        this.name = '';
        this.visitTime = new Date();
    }
    return VisitedRoute;
}());
export { VisitedRoute };
function VisitedRoute_tsickle_Closure_declarations() {
    /** @type {?} */
    VisitedRoute.prototype.label;
    /** @type {?} */
    VisitedRoute.prototype.link;
    /** @type {?} */
    VisitedRoute.prototype.name;
    /** @type {?} */
    VisitedRoute.prototype.visitTime;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGNhaXUvbGlicmFyeS8iLCJzb3VyY2VzIjpbImxpYi9yb3V0ZXIvbW9kZWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBZ0JBLE9BQU8sRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFHckQsSUFBQTs7eUJBQ2dCLEVBQUU7O2dDQXBCbEI7SUFzQkMsQ0FBQTtBQUhELGlDQUdDOzs7Ozs7O0FBRUQsSUFBQTtJQUVJLHFCQUFtQixRQUF3QjtRQUF4QixhQUFRLEdBQVIsUUFBUSxDQUFnQjtLQUMxQztzQkEzQkw7SUE2QkMsQ0FBQTtBQUxELHVCQUtDOzs7OztBQUVELElBQUE7SUFNSSxxQkFBWSxLQUFzQjt3QkFMUCxFQUFFOzRCQUNFLEVBQUU7cUJBRWpCLEVBQUU7UUFHZCxXQUFXLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0tBQzVCO0lBRUQsc0JBQUksNkJBQUk7Ozs7UUFBUjtZQUNJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1NBQ3JCOzs7OztRQUVELFVBQVMsS0FBYTtZQUNsQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztTQUN0Qjs7O09BSkE7SUFNRCxzQkFBSSw4QkFBSzs7OztRQUFUO1lBQ0ksTUFBTSxDQUFDO2dCQUNILFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUztnQkFDekIsUUFBUSxtQkFDRCxJQUFJLENBQUMsUUFBUSxFQUNiLElBQUksQ0FBQyxZQUFZLENBQ3ZCO2FBQ0osQ0FBQTtTQUNKOzs7T0FBQTtzQkF6REw7SUEwREMsQ0FBQTtBQTNCRCx1QkEyQkM7Ozs7Ozs7Ozs7O0FBRUQsSUFBQTtJQUErQixxQ0FBVztJQUV0QyxtQkFBWSxLQUFzQjtRQUFsQyxZQUNJLGtCQUFNLEtBQUssQ0FBQyxTQUVmO1FBREcsS0FBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7O0tBQ2xCO29CQWpFTDtFQTREK0Is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LENBQUMsZ0JBQWdCO1lBQ25ELE1BQU0sRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQztZQUN2RSxFQUFFLEVBQUUsT0FBTyxDQUFDLEVBQUU7WUFDZCxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7WUFDcEIsR0FBRyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1lBQ2hCLGlCQUFpQixFQUFFLE9BQU8sQ0FBQyxpQkFBaUI7U0FDL0MsQ0FBQyxDQUFDO0tBQ1Y7c0JBclJMO0lBdVJDLENBQUE7QUFqS0QsdUJBaUtDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUQsSUFBQTs7cUJBQ1ksRUFBRTtvQkFDSCxFQUFFO29CQUNGLEVBQUU7eUJBQ0csSUFBSSxJQUFJLEVBQUU7O3VCQTdSMUI7SUE4UkMsQ0FBQTtBQUxELHdCQUtDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gICAgUm91dGUsXHJcbiAgICBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LFxyXG4gICAgRXZlbnQsXHJcbiAgICBOYXZpZ2F0aW9uQ2FuY2VsLFxyXG4gICAgTmF2aWdhdGlvbkVuZCxcclxuICAgIE5hdmlnYXRpb25FcnJvcixcclxuICAgIE5hdmlnYXRpb25TdGFydCxcclxuICAgIFJvdXRlc1JlY29nbml6ZWQsXHJcbiAgICBSb3V0ZXJTdGF0ZVNuYXBzaG90LFxyXG4gICAgVXJsU2VnbWVudCxcclxuICAgIFBhcmFtcyxcclxuICAgIERhdGFcclxufSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5cclxuaW1wb3J0IHsgYnVpbGQsIGFzc2lnblByb3BzIH0gZnJvbSAnLi4vc2hhcmVkL3V0aWxzJztcclxuaW1wb3J0IHsgRGljdGlvbmFyeSB9IGZyb20gJy4uL3NoYXJlZC9tb2RlbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEFjdGl2YXRlZFJvdXRlUGF5bG9hZCB7XHJcbiAgICByb3V0ZU5hbWUgPSAnJztcclxuICAgIHBhcmVudD86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEJyZWFkY3J1bWJzIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc2VnbWVudHM6IFJvdXRlU2VnbWVudFtdKSB7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ3VzdG9tUm91dGUgaW1wbGVtZW50cyBSb3V0ZSB7XHJcbiAgICBwdWJsaWMgY2hpbGRyZW46IFJvdXRlW10gPSBbXTtcclxuICAgIHB1YmxpYyBsYXp5Q2hpbGRyZW46IFJvdXRlW10gPSBbXTtcclxuICAgIHB1YmxpYyBjb21wb25lbnQ6IFR5cGU8YW55PjtcclxuICAgIHByaXZhdGUgX3BhdGggPSAnJztcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogRGljdGlvbmFyeTxhbnk+KSB7XHJcbiAgICAgICAgYXNzaWduUHJvcHModGhpcywgcHJvcHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBwYXRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYXRoO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwYXRoKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLl9wYXRoID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHJvdXRlKCk6IFJvdXRlIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb21wb25lbnQ6IHRoaXMuY29tcG9uZW50LFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogW1xyXG4gICAgICAgICAgICAgICAgLi4udGhpcy5jaGlsZHJlbixcclxuICAgICAgICAgICAgICAgIC4uLnRoaXMubGF6eUNoaWxkcmVuXHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBMYXp5Um91dGUgZXh0ZW5kcyBDdXN0b21Sb3V0ZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHM6IERpY3Rpb25hcnk8YW55Pikge1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICB0aGlzLnBhdGggPSAnJztcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSb3V0ZXJFdmVudCB7XHJcbiAgICBldmVudFR5cGU6IGFueTtcclxuICAgIGV2ZW50OiBFdmVudDtcclxuICAgIG5hdmlnYXRpb25DYW5jZWw/OiBOYXZpZ2F0aW9uQ2FuY2VsO1xyXG4gICAgbmF2aWdhdGlvbkVuZD86IE5hdmlnYXRpb25FbmQ7XHJcbiAgICBuYXZpZ2F0aW9uRXJyb3I/OiBOYXZpZ2F0aW9uRXJyb3I7XHJcbiAgICBuYXZpZ2F0aW9uU3RhcnQ/OiBOYXZpZ2F0aW9uU3RhcnQ7XHJcbiAgICByb3V0ZXNSZWNvZ25pemVkPzogUm91dGVzUmVjb2duaXplZDtcclxufVxyXG5cclxuZXhwb3J0IGVudW0gTmF2aWdhdGlvblN0YXR1cyB7XHJcbiAgICBEZWZhdWx0LFxyXG4gICAgTmF2aWdhdGlvblN0YXJ0LFxyXG4gICAgTmF2aWdhdGlvbkNhbmNlbCxcclxuICAgIE5hdmlnYXRpb25FcnJvcixcclxuICAgIFJvdXRlc1JlY29nbml6ZWQsXHJcbiAgICBOYXZpZ2F0aW9uRW5kXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSb3V0ZVNlZ21lbnQge1xyXG4gICAgLyoqIFRoZSBzdGF0aWMgYW5kIHJlc29sdmVkIGRhdGEgb2YgdGhpcyByb3V0ZSAqL1xyXG4gICAgZGF0YTogRGF0YTtcclxuICAgIC8qKiBUaGUgVVJMIGZyYWdtZW50IHNoYXJlZCBieSBhbGwgdGhlIHJvdXRlcyAqL1xyXG4gICAgZnJhZ21lbnQgPSAnJztcclxuICAgIC8qKiBUaGUgb3JkZXIgb2YgdGhlIHNlZ21lbnQgaW4gdGhlIHJvdXRlICovXHJcbiAgICBvcmRlciA9IDA7XHJcbiAgICAvKiogVGhlIG91dGxldCBuYW1lIG9mIHRoZSByb3V0ZSAqL1xyXG4gICAgb3V0bGV0ID0gJyc7XHJcbiAgICAvKiogVGhlIHBhdGggZnJvbSB0aGUgcm9vdCBvZiB0aGUgcm91dGVyIHN0YXRlIHRyZWUgdG8gdGhpcyByb3V0ZSAqL1xyXG4gICAgcGF0aEZyb21Sb290OiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90W107XHJcbiAgICAvKiogVGhlIG1hdHJpeCBwYXJhbWV0ZXJzIHNjb3BlZCB0byB0aGlzIHJvdXRlICovXHJcbiAgICBwYXJhbXM6IFBhcmFtcztcclxuICAgIC8qKiBUaGUgbGFiZWwgdG8gcGFzcyB0byB0aGUgYW5jaG9yIHRhZyAqL1xyXG4gICAgcm91dGVMYWJlbCA9ICcnO1xyXG4gICAgLyoqIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHJvdXRlIHNlZ21lbnQgKi9cclxuICAgIHJvdXRlTmFtZSA9ICcnO1xyXG4gICAgLyoqIFRoZSBVUkwgc2VnbWVudHMgbWF0Y2hlZCBieSB0aGlzIHJvdXRlICovXHJcbiAgICB1cmw6IFVybFNlZ21lbnRbXTtcclxuXHJcbiAgICAvKiogVGhlIGxpbmsgdG8gcGFzcyB0byB0aGUgYW5jaG9yIHRhZyAqL1xyXG4gICAgZ2V0IHJvdXRlckxpbmsoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYXRoRnJvbVJvb3RcclxuICAgICAgICAgICAgLm1hcChyID0+IHIudXJsKVxyXG4gICAgICAgICAgICAucmVkdWNlKChhY2MsIHgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnQgPSBSb3V0ZXJTdGF0ZS5CdWlsZFVybFNlZ21lbnQoeCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VnbWVudCAmJiBzZWdtZW50ICE9PSAnLycgPyBgJHthY2N9JHtzZWdtZW50fWAgOiBhY2M7XHJcbiAgICAgICAgICAgIH0sICcnKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJvdXRlclN0YXRlIHtcclxuICAgIGlkID0gMDtcclxuICAgIGFjdGl2YXRlZFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90O1xyXG4gICAgZXJyb3I6IGFueSA9IHVuZGVmaW5lZDtcclxuICAgIGV2ZW50czogUm91dGVyRXZlbnRbXSA9IFtdO1xyXG4gICAgaGlzdG9yeTogVmlzaXRlZFJvdXRlW10gPSBbXTtcclxuICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMgPSBOYXZpZ2F0aW9uU3RhdHVzLkRlZmF1bHQ7XHJcbiAgICByZWFzb24gPSAnJztcclxuICAgIHJvb3RSb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdDtcclxuICAgIHN0YXRlOiBSb3V0ZXJTdGF0ZVNuYXBzaG90ID0gdW5kZWZpbmVkO1xyXG4gICAgdXJsID0gJyc7XHJcbiAgICB1cmxBZnRlclJlZGlyZWN0cyA9ICcnO1xyXG5cclxuICAgIHN0YXRpYyBCdWlsZFJvdXRlKHByb3BzOiBEaWN0aW9uYXJ5PGFueT4pOiBSb3V0ZSB7XHJcbiAgICAgICAgY29uc3QgciA9IG5ldyBDdXN0b21Sb3V0ZShwcm9wcyk7XHJcbiAgICAgICAgcmV0dXJuIDxSb3V0ZT5yO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBCdWlsZExhenlSb3V0ZShwcm9wczogRGljdGlvbmFyeTxhbnk+KTogUm91dGUge1xyXG4gICAgICAgIGNvbnN0IHIgPSBuZXcgTGF6eVJvdXRlKHByb3BzKTtcclxuICAgICAgICByZXR1cm4gPFJvdXRlPnI7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEJ1aWxkVXJsU2VnbWVudCh1cmw6IFVybFNlZ21lbnRbXSk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHVybC5yZWR1Y2UoKGFjYywgc2VnbWVudCkgPT4gc2VnbWVudC5wYXRoICYmIHNlZ21lbnQucGF0aCAhPT0gJy8nID8gYCR7YWNjfS8ke3NlZ21lbnQucGF0aH1gIDogYWNjLCAnJyk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEdldEFjdGl2YXRlZE91dGxldHMocm9vdDogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCwgaW5kZXggPSAwKTogRGljdGlvbmFyeTxSb3V0ZVNlZ21lbnQ+IHtcclxuICAgICAgICByZXR1cm4gcm9vdCA/IHJvb3QuY2hpbGRyZW4ucmVkdWNlKChhY2M6IERpY3Rpb25hcnk8Um91dGVTZWdtZW50PiwgcjogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCwgY3VycmVudEluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBpbmRleCArIGN1cnJlbnRJbmRleDtcclxuICAgICAgICAgICAgY29uc3Qgcm91dGVOYW1lID0gUm91dGVyU3RhdGUuR2V0Um91dGVOYW1lKHIpO1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IGJ1aWxkKFJvdXRlU2VnbWVudCwgYWNjW3JvdXRlTmFtZV0pO1xyXG4gICAgICAgICAgICBjb25zdCBvdXRsZXQgPSBSb3V0ZXJTdGF0ZS5HZXRSb3V0ZVNlZ21lbnQociwgZXhpc3RpbmcsIGkpO1xyXG4gICAgICAgICAgICByZXR1cm4gcm91dGVOYW1lID8gT2JqZWN0LmFzc2lnbihhY2MsIFJvdXRlclN0YXRlLkdldEFjdGl2YXRlZE91dGxldHMociwgaSArIDEpLCB7IFtyb3V0ZU5hbWVdOiBvdXRsZXQgfSlcclxuICAgICAgICAgICAgICAgIDogT2JqZWN0LmFzc2lnbihhY2MsIFJvdXRlclN0YXRlLkdldEFjdGl2YXRlZE91dGxldHMociwgaSArIDEpKTtcclxuICAgICAgICB9LCB7fSkgOiB7fTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0QWN0aXZhdGVkUm91dGUocm9vdDogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCk6IEFjdGl2YXRlZFJvdXRlU25hcHNob3Qge1xyXG4gICAgICAgIHJldHVybiByb290LmNoaWxkcmVuLnJlZHVjZSgoYWNjOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LCByOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBSb3V0ZXJTdGF0ZS5HZXRBY3RpdmF0ZWRSb3V0ZShyKTtcclxuICAgICAgICB9LCByb290KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgR2V0QWxsUGFyYW1zKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KTogYW55IHtcclxuICAgICAgICByZXR1cm4gcm91dGUgPyByb3V0ZS5jaGlsZHJlbi5yZWR1Y2UoKGFjYzogYW55LCByOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBhY2MsIFJvdXRlclN0YXRlLkdldEFsbFBhcmFtcyhyKSk7XHJcbiAgICAgICAgfSwgT2JqZWN0LmFzc2lnbih7fSwgcm91dGUucGFyYW1zLCByb3V0ZS5xdWVyeVBhcmFtcykpIDoge307XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEdldFJvdXRlRGF0YShyb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCk6IGFueSB7XHJcbiAgICAgICAgcmV0dXJuIHJvdXRlLmRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEdldFJvdXRlU2VnbWVudChyb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCwgZXhpc3Rpbmc6IFJvdXRlU2VnbWVudCA9IG5ldyBSb3V0ZVNlZ21lbnQoKSwgaW5kZXggPSAwKTogUm91dGVTZWdtZW50IHtcclxuICAgICAgICBjb25zdCByb3V0ZU5hbWUgPSBSb3V0ZXJTdGF0ZS5HZXRSb3V0ZU5hbWUocm91dGUpO1xyXG4gICAgICAgIHJldHVybiBidWlsZChSb3V0ZVNlZ21lbnQsIGV4aXN0aW5nLCB7XHJcbiAgICAgICAgICAgIGRhdGE6IHJvdXRlLmRhdGEsXHJcbiAgICAgICAgICAgIGZyYWdtZW50OiByb3V0ZS5mcmFnbWVudCxcclxuICAgICAgICAgICAgb3JkZXI6IGluZGV4LFxyXG4gICAgICAgICAgICBvdXRsZXQ6IHJvdXRlLm91dGxldCxcclxuICAgICAgICAgICAgcGF0aEZyb21Sb290OiByb3V0ZS5wYXRoRnJvbVJvb3QsXHJcbiAgICAgICAgICAgIHBhcmFtczogcm91dGUucGFyYW1zLFxyXG4gICAgICAgICAgICByb3V0ZU5hbWUsXHJcbiAgICAgICAgICAgIHJvdXRlTGFiZWw6IFJvdXRlclN0YXRlLkdldFJvdXRlRGF0YShyb3V0ZSlbJ3JvdXRlTGFiZWwnXSB8fCBleGlzdGluZy5yb3V0ZUxhYmVsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIEdldFJvdXRlTmFtZShyb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHJvdXRlID8gUm91dGVyU3RhdGUuR2V0Um91dGVEYXRhKHJvdXRlKVsncm91dGVOYW1lJ10gOiAnJztcclxuICAgIH1cclxuXHJcbiAgICBnZXQgYWN0aXZhdGVkT3V0bGV0cygpOiBEaWN0aW9uYXJ5PFJvdXRlU2VnbWVudD4ge1xyXG4gICAgICAgIHJldHVybiBSb3V0ZXJTdGF0ZS5HZXRBY3RpdmF0ZWRPdXRsZXRzKHRoaXMucm9vdFJvdXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgbGFzdEV2ZW50KCk6IFJvdXRlckV2ZW50IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ldmVudHNbLTFdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBwYXJhbXMoKTogYW55IHtcclxuICAgICAgICByZXR1cm4gUm91dGVyU3RhdGUuR2V0QWxsUGFyYW1zKHRoaXMucm9vdFJvdXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgcm91dGVOYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIFJvdXRlclN0YXRlLkdldFJvdXRlTmFtZSh0aGlzLmFjdGl2YXRlZFJvdXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdmlzaXRlZCgpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5tYXAoeCA9PiB4LmxpbmspO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZFJvdXRlckV2ZW50KGU6IEV2ZW50LCBldmVudFR5cGU6IGFueSk6IFJvdXRlckV2ZW50W10ge1xyXG4gICAgICAgIGNvbnN0IG5ld0V2ZW50ID0gPFJvdXRlckV2ZW50PnsgZXZlbnRUeXBlOiBldmVudFR5cGUsIGV2ZW50OiBlIH07XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgLi4udGhpcy5ldmVudHMsXHJcbiAgICAgICAgICAgIG5ld0V2ZW50XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICBuYXZpZ2F0aW9uQ2FuY2VsKHBheWxvYWQ6IE5hdmlnYXRpb25DYW5jZWwpOiBSb3V0ZXJTdGF0ZSB7XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFJvdXRlclN0YXRlLCB0aGlzLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYXZpZ2F0aW9uU3RhdHVzOiBOYXZpZ2F0aW9uU3RhdHVzLk5hdmlnYXRpb25DYW5jZWwsXHJcbiAgICAgICAgICAgICAgICBldmVudHM6IHRoaXMuYWRkUm91dGVyRXZlbnQocGF5bG9hZCwgTmF2aWdhdGlvblN0YXR1cy5OYXZpZ2F0aW9uQ2FuY2VsKSxcclxuICAgICAgICAgICAgICAgIGlkOiBwYXlsb2FkLmlkLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBwYXlsb2FkLnVybCxcclxuICAgICAgICAgICAgICAgIHJlYXNvbjogcGF5bG9hZC5yZWFzb25cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmF2aWdhdGlvbkVuZChwYXlsb2FkOiBOYXZpZ2F0aW9uRW5kKTogUm91dGVyU3RhdGUge1xyXG4gICAgICAgIGNvbnN0IGhpc3RvcnkgPSBbcGF5bG9hZC50b1N0cmluZygpLCAuLi50aGlzLmhpc3RvcnldO1xyXG4gICAgICAgIHJldHVybiBidWlsZChSb3V0ZXJTdGF0ZSwgdGhpcyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaGlzdG9yeSxcclxuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvbkVuZCxcclxuICAgICAgICAgICAgICAgIGV2ZW50czogdGhpcy5hZGRSb3V0ZXJFdmVudChwYXlsb2FkLCBOYXZpZ2F0aW9uU3RhdHVzLk5hdmlnYXRpb25FbmQpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IHBheWxvYWQuaWQsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHBheWxvYWQudXJsLFxyXG4gICAgICAgICAgICAgICAgdXJsQWZ0ZXJSZWRpcmVjdHM6IHBheWxvYWQudXJsQWZ0ZXJSZWRpcmVjdHNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmF2aWdhdGlvbkVycm9yKHBheWxvYWQ6IE5hdmlnYXRpb25FcnJvcik6IFJvdXRlclN0YXRlIHtcclxuICAgICAgICByZXR1cm4gYnVpbGQoUm91dGVyU3RhdGUsIHRoaXMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvbkVycm9yLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRzOiB0aGlzLmFkZFJvdXRlckV2ZW50KHBheWxvYWQsIE5hdmlnYXRpb25TdGF0dXMuTmF2aWdhdGlvbkVycm9yKSxcclxuICAgICAgICAgICAgICAgIGlkOiBwYXlsb2FkLmlkLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBwYXlsb2FkLnVybCxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBwYXlsb2FkLmVycm9yXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG5hdmlnYXRpb25TdGFydChwYXlsb2FkOiBOYXZpZ2F0aW9uU3RhcnQpOiBSb3V0ZXJTdGF0ZSB7XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFJvdXRlclN0YXRlLCB0aGlzLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYXZpZ2F0aW9uU3RhdHVzOiBOYXZpZ2F0aW9uU3RhdHVzLk5hdmlnYXRpb25TdGFydCxcclxuICAgICAgICAgICAgICAgIGV2ZW50czogdGhpcy5hZGRSb3V0ZXJFdmVudChwYXlsb2FkLCBOYXZpZ2F0aW9uU3RhdHVzLk5hdmlnYXRpb25TdGFydCksXHJcbiAgICAgICAgICAgICAgICBpZDogcGF5bG9hZC5pZCxcclxuICAgICAgICAgICAgICAgIHVybDogcGF5bG9hZC51cmxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcm91dGVzUmVjb2duaXplZChwYXlsb2FkOiBSb3V0ZXNSZWNvZ25pemVkKTogUm91dGVyU3RhdGUge1xyXG4gICAgICAgIGNvbnN0IHJvb3RSb3V0ZSA9IHBheWxvYWQuc3RhdGUucm9vdDtcclxuICAgICAgICBjb25zdCBhY3RpdmF0ZWRSb3V0ZSA9IFJvdXRlclN0YXRlLkdldEFjdGl2YXRlZFJvdXRlKHJvb3RSb3V0ZSk7XHJcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFJvdXRlclN0YXRlLCB0aGlzLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmF0ZWRSb3V0ZSxcclxuICAgICAgICAgICAgICAgIHJvb3RSb3V0ZSxcclxuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25TdGF0dXM6IE5hdmlnYXRpb25TdGF0dXMuUm91dGVzUmVjb2duaXplZCxcclxuICAgICAgICAgICAgICAgIGV2ZW50czogdGhpcy5hZGRSb3V0ZXJFdmVudChwYXlsb2FkLCBOYXZpZ2F0aW9uU3RhdHVzLlJvdXRlc1JlY29nbml6ZWQpLFxyXG4gICAgICAgICAgICAgICAgaWQ6IHBheWxvYWQuaWQsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogcGF5bG9hZC5zdGF0ZSxcclxuICAgICAgICAgICAgICAgIHVybDogcGF5bG9hZC51cmwsXHJcbiAgICAgICAgICAgICAgICB1cmxBZnRlclJlZGlyZWN0czogcGF5bG9hZC51cmxBZnRlclJlZGlyZWN0c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBWaXNpdGVkUm91dGUge1xyXG4gICAgbGFiZWwgPSAnJztcclxuICAgIGxpbmsgPSAnJztcclxuICAgIG5hbWUgPSAnJztcclxuICAgIHZpc2l0VGltZSA9IG5ldyBEYXRlKCk7XHJcbn1cclxuIl19